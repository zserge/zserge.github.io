<!doctype html><html lang=en><head><meta charset=utf-8><title>Distraction free writing in Vim</title><meta name=description content="Ultra-simple distraction free mode for vim"><meta name=author content="Serge Zaitsev"><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1"><link rel="shortcut icon" href=data:,><link rel="shortcut icon" sizes=32x32 href=/favicon.png><link rel="shortcut icon" sizes=192x192 href=/favicon-192x192.png><link rel=apple-touch-icon href=/favicon-192x192.png><link rel=alternate type=application/rss+xml title=RSS href=/rss.xml><link rel=canonical href=https://zserge.com/posts/vim-distraction-free/><meta property="og:title" content="Distraction free writing in Vim"><meta property="og:type" content="article"><meta property="og:url" content="https://zserge.com/posts/vim-distraction-free/"><meta property="og:image" content="https://zserge.com/logo.png"><meta property="og:description" content="Ultra-simple distraction free mode for vim"><meta property="og:locale" content="en_US"><meta name=twitter:card content="Ultra-simple distraction free mode for vim"><meta name=twitter:site content="@zsergo"><style type=text/css>body{padding:1rem;margin:auto;max-width:46rem;font-family:pt serif,Georgia,Cambria,times new roman,Times,serif;line-height:1.5;font-size:20px;color:rgba(0,0,0,.87);-webkit-font-smoothing:antialiased;font-weight:300}nav{display:flex;justify-content:space-between;align-items:center;margin:1em 0 3em}nav ul,nav li{display:inline-block;list-style:none;margin:0 0 0 .5rem;padding:0}nav ul{margin-right:1rem}.logo{background-color:rgba(0,0,0,.87);color:#fff;min-width:48px;min-height:48px;font-size:28px;border-radius:2px;display:flex;justify-content:center;align-items:center}.logo:hover{color:#fff}h1,h2{line-height:1.2;font-family:roboto,system-ui,segoe ui,Helvetica,Arial,sans-serif;font-weight:400;text-transform:uppercase;margin:1.34em 0 0}h1{font-size:1.95em}h2{font-size:1.25em;border-bottom:2px solid rgba(0,0,0,.87)}h1 a{color:rgba(0,0,0,.87)}p{margin:.67em 0 1em}a{color:#0076df;text-decoration:none;word-break:break-word}a:hover{color:rgba(0,0,0,.87)}ul,ol{list-style-position:outside;margin-left:1em}img{display:block;margin-left:auto;margin-right:auto;max-width:100%}pre,code{font-family:roboto mono,SFMono-Regular,Consolas,liberation mono,Menlo,monospace;font-weight:400;font-size:18px;color:rgba(0,0,0,.6);background:#eee}code{padding:.2rem .4rem;font-size:14px;border-radius:2px}pre{overflow-y:auto;line-height:20px;border-radius:2px;padding:1em}pre code{font-size:14px;padding:0;color:rgba(0,0,0,.87)}footer{font-size:12px}@media(prefers-color-scheme:dark){.logo{color:#444;background-color:#e4e4e4}.logo:hover{color:#444}body,h1 a,h2 a{background-color:#444;color:#e4e4e4}pre,pre code{background:#333;color:#e4e4e4}h2{border-bottom:1px solid #e4e4e4}code{color:#aaa;background:#333}a{color:#e39777}a:hover{color:#e4e4e4}img{filter:grayscale(30%)}}.hl{display:block;width:100%;background-color:#ffc}.ow,.gh,.gp,.gs,.gu,.nt,.nn,.ne,.ni,.nc,.kr,.kn,.kd,.kc,.k{font-weight:700}.c,.ch,.cm,.c1,.cs,.ge{color:#777}</style><link rel="shortcut icon" href=/favicon.ico></head><body><header><nav><a class=logo href=/>Z</a><ul><li><a href=/about/>about</a></li><li><a href=/posts/>posts</a></li><li><a href=https://twitter.com/zsergo>@me</a></li><li><a href=https://github.com/zserge>&lt;/>me</a></li></ul></nav></header><div id=content><h1>Distraction free writing in Vim</h1><p>I use Vim as a plain text editor for everything. Apart from coding, I write blog posts in vim, create quick notes and draft design documents. Surprisingly, I haven&rsquo;t customized it a lot and am very lean about the plugins. While keeping my setup austerely simple, I rarely lack any of the functionality.</p><p>However, recently I wondered if I can achieve a &ldquo;distraction free&rdquo; experience with Vim, like when you see a full screen text, nicely centered, and nothing else:</p><p><img src=/images/distraction-free.png alt=distrction-free></p><h2 id=distraction-free>Distraction free</h2><p>To achieve distraction free editing in Vim, one would have to:</p><ul><li>Add wide margins from left/top/right/bottom to make text appear centered.</li><li>Hide ugly tildas that mark the absence of text below the end of file.</li><li>Hide status bars</li><li>Enable line wrapping and map j/k to gj/gk to make wrapped lines navigation more human-friendly.</li></ul><p>The last item is trivial: <code>set wrap</code>, <code>set lbr</code>, <code>map j gj</code>, <code>map k gk</code>.</p><p>Hiding elements. Well, this may sound tricky if we want to really hide elements. But what we really want is to visually hide them. They will still be there, but won&rsquo;t be visible. This can be easily achieved by changing foreground color of such elements to match background color.</p><p>Finally, margins. One seemingly simple way to make left margin is to use line numbers and folds, make them as wide as needed and colorize to match the background. Right margin can be achieved by limiting the number of columns. But in practice, it&rsquo;s a very limited approach. Left margin can only be as wide as 20 columns (because each part, numbers and folds, can take up to 10 columns). And it makes it impossible to use numbers and folds in the editor.</p><p>An alternative would be to create fake split windows on the left, right, top and bottom, then make the splits invisible by colorizing them.</p><p>So, let&rsquo;s implement it like that.</p><h2 id=implementation>Implementation</h2><p>Here&rsquo;s a code snippet. Feel free to put it into your <code>.vimrc</code>:</p><div class=highlight><pre class=chroma><code class=language-viml data-lang=viml><span class=k>let</span> <span class=nx>g</span>:<span class=nx>dfm_width</span> <span class=p>=</span> <span class=m>80</span> <span class=c>&#34;absolute width or percentage, like 0.7</span><span class=err>
</span><span class=err></span><span class=k>let</span> <span class=nx>g</span>:<span class=nx>dfm_height</span> <span class=p>=</span> <span class=m>0</span>.<span class=m>8</span><span class=err>
</span><span class=err>
</span><span class=err></span><span class=k>let</span> <span class=nx>s</span>:<span class=nx>dfm_enabled</span> <span class=p>=</span> <span class=m>0</span><span class=err>
</span><span class=err>
</span><span class=err></span><span class=k>function</span><span class=p>!</span> <span class=nx>ToggleDistractionFreeMode</span><span class=p>()</span><span class=err>
</span><span class=err></span>  <span class=k>let</span> <span class=nx>l</span>:<span class=nx>w</span> <span class=p>=</span> <span class=nx>g</span>:<span class=nx>dfm_width</span> <span class=p>&gt;</span> <span class=m>1</span> ? <span class=nx>g</span>:<span class=nx>dfm_width</span> : <span class=p>(</span><span class=nx>winwidth</span><span class=p>(</span><span class=s1>&#39;%&#39;</span><span class=p>)</span> * <span class=nx>g</span>:<span class=nx>dfm_width</span><span class=p>)</span><span class=err>
</span><span class=err></span>  <span class=k>let</span> <span class=nx>l</span>:<span class=nx>margins</span> <span class=p>=</span> {<span class=err>
</span><span class=err></span>	\ <span class=s2>&#34;l&#34;</span>: <span class=p>(</span><span class=s2>&#34;silent leftabove &#34;</span> . <span class=nx>float2nr</span><span class=p>((</span><span class=nx>winwidth</span><span class=p>(</span><span class=s1>&#39;%&#39;</span><span class=p>)</span> <span class=p>-</span> <span class=nx>l</span>:<span class=nx>w</span><span class=p>)</span> / <span class=m>2</span> <span class=p>-</span> <span class=m>1</span><span class=p>)</span> . <span class=s2>&#34; vsplit new&#34;</span><span class=p>),</span><span class=err>
</span><span class=err></span>	\ <span class=s2>&#34;h&#34;</span>: <span class=p>(</span><span class=s2>&#34;silent rightbelow &#34;</span> . <span class=nx>float2nr</span><span class=p>((</span><span class=nx>winwidth</span><span class=p>(</span><span class=s1>&#39;%&#39;</span><span class=p>)</span> <span class=p>-</span> <span class=nx>l</span>:<span class=nx>w</span><span class=p>)</span> / <span class=m>2</span> <span class=p>-</span> <span class=m>1</span><span class=p>)</span> . <span class=s2>&#34; vsplit new&#34;</span><span class=p>),</span><span class=err>
</span><span class=err></span>	\ <span class=s2>&#34;j&#34;</span>: <span class=p>(</span><span class=s2>&#34;silent leftabove &#34;</span> . <span class=nx>float2nr</span><span class=p>(</span><span class=nx>winheight</span><span class=p>(</span><span class=s1>&#39;%&#39;</span><span class=p>)</span> * <span class=p>(</span><span class=m>1</span> <span class=p>-</span> <span class=nx>g</span>:<span class=nx>dfm_height</span><span class=p>)</span> / <span class=m>2</span> <span class=p>-</span> <span class=m>1</span><span class=p>)</span> . <span class=s2>&#34; split new&#34;</span><span class=p>),</span><span class=err>
</span><span class=err></span>	\ <span class=s2>&#34;k&#34;</span>: <span class=p>(</span><span class=s2>&#34;silent rightbelow &#34;</span> . <span class=nx>float2nr</span><span class=p>(</span><span class=nx>winheight</span><span class=p>(</span><span class=s1>&#39;%&#39;</span><span class=p>)</span> * <span class=p>(</span><span class=m>1</span> <span class=p>-</span> <span class=nx>g</span>:<span class=nx>dfm_height</span><span class=p>)</span> / <span class=m>2</span> <span class=p>-</span> <span class=m>1</span><span class=p>)</span> . <span class=s2>&#34; split new&#34;</span><span class=p>),</span><span class=err>
</span><span class=err></span>	\ }<span class=err>
</span><span class=err></span>  <span class=k>if</span> <span class=p>(</span><span class=nx>s</span>:<span class=nx>dfm_enabled</span> <span class=p>==</span> <span class=m>0</span><span class=p>)</span><span class=err>
</span><span class=err></span>    <span class=k>let</span> <span class=nx>s</span>:<span class=nx>dfm_enabled</span> <span class=p>=</span> <span class=m>1</span><span class=err>
</span><span class=err></span>    <span class=nx>for</span> <span class=nx>key</span> <span class=nx>in</span> <span class=nx>keys</span><span class=p>(</span><span class=nx>l</span>:<span class=nx>margins</span><span class=p>)</span><span class=err>
</span><span class=err></span>      <span class=nx>execute</span> <span class=nx>l</span>:<span class=nx>margins</span>[<span class=nx>key</span>] . <span class=s2>&#34; | wincmd &#34;</span> . <span class=nx>key</span><span class=err>
</span><span class=err></span>    <span class=nx>endfor</span><span class=err>
</span><span class=err></span>    <span class=nx>for</span> <span class=nx>key</span> <span class=nx>in</span> [<span class=s1>&#39;NonText&#39;</span><span class=p>,</span> <span class=s1>&#39;VertSplit&#39;</span><span class=p>,</span> <span class=s1>&#39;StatusLine&#39;</span><span class=p>,</span> <span class=s1>&#39;StatusLineNC&#39;</span>]<span class=err>
</span><span class=err></span>      <span class=nx>execute</span> <span class=s1>&#39;hi &#39;</span> . <span class=nx>key</span> . <span class=s1>&#39; ctermfg=bg ctermbg=bg cterm=NONE&#39;</span><span class=err>
</span><span class=err></span>    <span class=nx>endfor</span><span class=err>
</span><span class=err></span>    <span class=nx>set</span> <span class=nx>wrap</span> <span class=p>|</span> <span class=nx>set</span> <span class=nx>linebreak</span><span class=err>
</span><span class=err></span>    <span class=nx>map</span> <span class=nx>j</span> <span class=nx>gj</span><span class=err>
</span><span class=err></span>    <span class=nx>map</span> <span class=nx>k</span> <span class=nx>gk</span><span class=err>
</span><span class=err></span>  <span class=k>else</span><span class=err>
</span><span class=err></span>    <span class=k>let</span> <span class=nx>s</span>:<span class=nx>dfm_enabled</span> <span class=p>=</span> <span class=m>0</span><span class=err>
</span><span class=err></span>    <span class=nx>for</span> <span class=nx>key</span> <span class=nx>in</span> <span class=nx>keys</span><span class=p>(</span><span class=nx>l</span>:<span class=nx>margins</span><span class=p>)</span><span class=err>
</span><span class=err></span>      <span class=nx>execute</span> <span class=s2>&#34;wincmd &#34;</span> . <span class=nx>key</span> . <span class=s2>&#34; | close &#34;</span><span class=err>
</span><span class=err></span>    <span class=nx>endfor</span><span class=err>
</span><span class=err></span>    <span class=nx>set</span> <span class=nx>nowrap</span> <span class=p>|</span> <span class=nx>set</span> <span class=nx>nolinebreak</span><span class=err>
</span><span class=err></span>    <span class=nx>unmap</span> <span class=nx>j</span><span class=err>
</span><span class=err></span>    <span class=nx>unmap</span> <span class=nx>k</span><span class=err>
</span><span class=err></span>  <span class=k>endif</span><span class=err>
</span><span class=err></span><span class=k>endfunction</span><span class=err>
</span><span class=err>
</span><span class=err></span><span class=nx>nmap</span> <span class=p>&lt;</span><span class=nx>silent</span><span class=p>&gt;</span> <span class=p>&lt;</span><span class=nx>Leader</span><span class=p>&gt;</span><span class=nx>z</span> :<span class=nx>call</span> <span class=nx>ToggleDistractionFreeMode</span><span class=p>()&lt;</span><span class=nx>CR</span><span class=p>&gt;</span><span class=err>
</span></code></pre></div><p>We got two global configuration variables, width and height. Height is a percentage of the window height. Width can be a percentage, but I wound it easier to have absolute value (so that the text would look the same in ultra-wide windows and half-screen panes).</p><p>Then, we need to remember the current state of the windows to toggle them properly.</p><p>Finally, we have a function that opens 4 split windows, changes highlighting to hide the elements, and maps the key in one case, while closing the windows and unmapping the keys in the other case.</p><p>Note, that this may not work with color schemes when no background color is defined. You might get E420 error. In this case, add <code>hi Normal ctermbg=black</code> when distraction-free mode gets enabled, so that the background color would be forced to be black.</p><p>I know that there exists a number of plugins for distraction free writing mode in Vim. Still, the solution above is much smaller, and perfectly fits my needs (maybe yours, too). Plus, learning new things is always fun, even if it requires touching the VimScript.</p><p>I hope you’ve enjoyed this article. You can follow – and contribute to – on <a href=https://github.com/zserge>Github</a>, <a href=https://twitter.com/zsergo>Twitter</a> or subscribe via <a href=/rss.xml>rss</a>.</p><p class=date style=text-align:right><em>Oct 10, 2019</em></p><p>See also:
<a href=/posts/update-jknav/>new project: jknav</a> and <a href=/posts/>more</a>.</p></div><footer><p>&copy;2012&ndash;2021 &#183;
<a href=https://zserge.com>Serge Zaitsev</a> &#183;
<a href=mailto:zaitsev.serge@gmail.com>zaitsev.serge@gmail.com</a></p></footer><script>(function(e,t,n,i,s,a,c){e[n]=e[n]||function(){(e[n].q=e[n].q||[]).push(arguments)};a=t.createElement(i);c=t.getElementsByTagName(i)[0];a.async=true;a.src=s;c.parentNode.insertBefore(a,c)})(window,document,"galite","script","https://cdn.jsdelivr.net/npm/ga-lite@2/dist/ga-lite.min.js");galite('create','UA-33644825-1','auto');galite('send','pageview');</script><script>new Image().src='https://nullitics.com/file.gif?r='+encodeURI(document.referrer)+'&d='+screen.width</script><noscript><img src=https://nullitics.com/file.gif></noscript></body></html>